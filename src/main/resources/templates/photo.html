<!DOCTYPE html>
<html lang="pt-br" xmlns:th="https://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Photo</title>
  <link th:href="@{/css/output.css}" rel="stylesheet" />
  <link th:href="@{/css/photo.css}" rel="stylesheet" />
  <link th:href="@{/css/style.css}" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
</head>
<body>
<div th:insert="fragments/header :: header"></div>
<div id="post">
  <div id="photo">
    <img th:src="${linkPhoto}" alt="">
    <div id="like">
      <form th:if="${isLiked == false}" th:action="@{/photo/{photo_id}/like(photo_id=${photo_id})}" method="POST">
        <button type="submit"><i class="fa-regular fa-heart"></i></button>
      </form>
      <form th:if="${isLiked == true}" th:action="@{/photo/{photo_id}/unlike(photo_id=${photo_id})}" method="POST">
        <button type="submit"><i class="fa-solid fa-heart"></i></button>
      </form>
      <p th:text="${numberOfLikes}"></p>
    </div>

  </div>

  <div id="comments">
    <div id="comments-header">
      <div id="caption">
        <p th:if="${caption}" th:text="${caption}"></p>
      </div>
      <ul id="tags">
        <li th:each="tag : ${tags}" th:text="'#'+${tag}" class="tag"></li>
      </ul>
    </div>
    <ul id="photo-comments" role="list" class="divide-y divide-gray-400 overflow-y-auto">
      <li th:each="comment : ${comments}" class="flex justify-between gap-x-6 py-5 comment">
        <div class="flex min-w-0 gap-x-4">
          <div class="min-w-0 flex-auto">
            <p th:text="${comment.photographer.name}" class="text-sm/6 font-semibold text-gray-900"></p>
            <p th:text="${comment.commentText}" class="mt-1 text-sm/5 text-gray-500 break-words"></p>

            <div class="comment-actions" th:if="${comment.photographer.id == session.user_id}">
                <form th:action="@{/photo/{photo_id}/comment/{comment_id}/edit(photo_id=${photo_id}, comment_id=${comment.id})}"
                      method="GET"
                      class="text-sm/6" style="color: #3b82f6">
                    <button type="submit"><i class="fa-solid fa-pen"></i> Editar</button>
                </form>

                <form th:action="@{/photo/{photo_id}/comment/{comment_id}/delete(photo_id=${photo_id}, comment_id=${comment.id})}"
                      method="POST"
                      onsubmit="return confirm('Tem certeza que deseja excluir este coment치rio?')"
                      class="text-sm/6 text-red-500">

                    <button type="submit"><i class="fa-solid fa-trash-can"></i> Excluir</button>
                </form>
            </div>


          </div>
        </div>
        <div class="hidden shrink-0 sm:flex sm:flex-col sm:items-end">
          <p th:text="${comment.formattedCreatedAt}" class="text-sm/6 text-gray-900"></p>
        </div>
      </li>
    </ul>


    <form id="add-comment" th:action="@{/photo/{photo_id}/add-comment(photo_id=${photo_id})}" method="POST">
      <p th:if="${tooLong}">Coment치rio muito longo. Insira no m치ximo 512 caracteres</p>
      <input th:value="${sentComment}" type="text" name="comment" placeholder="Adicione um coment치rio">
      <button type="submit">Enviar</button>
    </form>
  </div>

</div>
</body>
</html>
